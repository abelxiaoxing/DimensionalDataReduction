# 赛题介绍
## 一、赛题任务背景

在图像识别、生物信息分析、材料科学等领域中，高维数据普遍存在，但其带来的“维度灾难”严重影响计算效率与模型性能。因此，需要使用高性能的降维算法，在保留主要信息的同时降低数据维度，从而提升任务执行效率和准确率。

你需要针对以下三类典型数据，分别设计降维算法，并完成分类任务与性能评估。

---

## 二、数据类型与说明

### 1. 手写体图像数据（MNIST）

- 文件名：`mnist-test-x.knd`
- 数据结构：
  - 第一行第一列是 `#no:truth`，表示后续每一行的第一个元素是样本编号和真实标签（如 `1:7` 表示第1个样本的真实数字为7）
  - 后续每行代表一个28×28像素的手写数字图像，共784个灰度值（0~1之间），总共有10,000个样本
- 原始维度：784维
- 应用任务：手写数字识别（0~9）

---

### 2. 葡萄酒数据（Wine Classification）

- 文件名：`wine.data`
- 数据结构：
  - 共178个样本，每行为一种葡萄酒
  - 第一列为类别标签（1、2、3），代表不同产地
  - 后续13列为特征参数（如酒精含量、镁含量等）
- 原始维度：13维
- 应用任务：葡萄酒产地分类

---

### 3. 材料拉曼光谱数据（Raman Spectra）

- 目录：`excellent_oriented/` 下有7645个 `.txt` 文件
- 文件命名示例：`Actinolite__R040063-4__Raman__514__0__ccw__Raman_Data_RAW__1508`
  - 包含矿物名称、样品编号、激光波长、入射角度、偏振方向、原始/预处理标志
- 数据格式：
  - 每个文件前12行为注释
  - 第13行开始为两列数据：第一列为拉曼位移（cm⁻¹），第二列为散射强度
- 处理方式区分：
  - RAW数据：原始未处理，可能存在噪声、基线漂移等问题
  - Processed数据：已校正荧光背景、平滑噪声、归一化强度等
- 数据对齐要求：
  - 对所有样本统一取相同范围（如200~1000 cm⁻¹）
  - 插值拟合后统一采样为1000个点
- 原始维度：1000维
- 应用任务：材料类别识别（如阳起石、方解石等）

---

## 三、任务要求

对于每类数据，需完成以下三个子任务：

### 1. 数据降维

- 使用合适的降维算法（如 PCA、t-SNE、UMAP、NMF、Autoencoder 等）
- 将数据从原始维度降至 2~100 维之间的指定维度
- 选择最佳算法并说明理由

### 2. 分类建模

- 在降维后的低维空间上，构建分类器（如 SVM、随机森林、神经网络等）
- 完成对应的应用任务（手写识别、产地分类、材料识别）

### 3. 性能评估

评估指标及其权重如下：

| 指标 | 权重 | 说明 |
|------|------|------|
| 分类准确率 | 50% | 分类任务的准确率 |
| 降维重构误差 | 20% | 如 MSE、SNR 等 |
| 降维比率 | 10% | 降维后维度 / 原始维度 |
| 运行时间 | 10% | 算法运行耗时 |
| 可视化效果 | 10% | 二维/三维空间中分布是否可解释 |

---

## 四、可视化与解释需求

请对降维后的特征向量进行可视化与解释：

- **手写体图像**：例如使用 NMF 可以得到若干“基图像”，这些图像是否能组合还原出原始图像？
- **葡萄酒数据**：降维后能否通过特征系数区分出不同产地？
- **光谱数据**：降维后的特征是否能有效反映材料类别差异？

---

## 五、任务要求
根据上述描述，完成以下工作：

1. 针对每类数据，提出适合的降维算法，并说明理由
2. 实现降维与分类流程
3. 输出性能评估结果（准确率、MSE、运行时间等）
4. 提供可视化结果与解释
5. 提供一个 demo 系统，支持用户输入新的样本数据（格式一致），输出重建误差
6. 重建误差越小，得分越高


# 技术方案及使用方法
## 数据与权重下载
下载压缩包,解压datas数据文件夹和models权重文件夹到当前根目录

通过网盘分享的文件：DimensionalDataReduction.7z
链接: https://pan.baidu.com/s/1URyOUMD2c_p_Nn9_7ZjfsA?pwd=abel 提取码: abel


## 1. 手写体图像（MNIST）降维与分类

### 降维算法：监督引导的变分自编码器（SG-VAE）
1. **监督引导的特征增强机制**：
   - 在VAE潜在空间中引入动态分类分支，通过分类损失（交叉熵）引导潜在特征生成，增强低维表示的类别区分性。
   - 分类分支采用轻量级全连接网络，动态调整潜在空间的语义分布，提升下游分类任务性能。

2. **自适应损失平衡策略**：
   - 设计了一种动态加权机制，通过强化学习（Q-learning）实时调节重构损失、KL散度及分类损失的权重。
   - 损失函数形式为：
     $$\mathcal{L} = \lambda_1 \cdot \mathcal{L}_{\text{recon}} + \lambda_2 \cdot \mathcal{L}_{\text{KL}} + \lambda_3 \cdot \mathcal{L}_{\text{class}}$$
     其中，\(\lambda_i\)由Q-learning控制器根据分类准确率与重构误差动态优化。

3. **语义增强潜在空间**：
   - 在潜在空间中融入类别先验信息，通过正则化约束使潜在表示更具语义可解释性。
   - 使用Wasserstein距离度量潜在分布与真实类别分布的差异，优化生成过程。

4. **多尺度特征提取**：
   - 编码器采用多尺度卷积结构，捕获从局部笔画到全局结构的图像特征，提升降维后的信息保留率。

### 分类模型：残差增强MLP（Res-MLP）
1. **残差连接**：
   - 在MLP网络中引入残差连接，缓解深层网络的梯度消失问题，提升训练稳定性。
   - 每层结构为：
     $$y = \text{SELU}(W \cdot x + b) + x$$

2. **SELU激活函数**：
   - 采用SELU（Scaled Exponential Linear Unit）激活函数，增强非线性表达能力并加速收敛。
   - SELU通过自归一化特性减少BatchNorm需求，降低计算开销。

3. **注意力机制**：
   - 在MLP输入层引入自注意力模块，增强对降维后特征的相关性建模，提升分类精度。

---

## 2. 葡萄酒特征（Wine）降维与分类
针对Wine数据集（178样本，13维，3类产地），我们设计了与MNIST类似的SG-VAE降维框架，并优化分类头以适配小样本场景。

### 降维算法：语义增强变分自编码器（SE-VAE）
1. **小样本适配的潜在空间正则化**：
   - 针对小样本数据，引入核密度估计（KDE）约束潜在空间分布，增强泛化能力。
   - 正则化项形式为：
     $$\mathcal{L}_{\text{KDE}} = -\sum_{i} \log p(z_i | \text{KDE})$$

2. **跨模态特征融合**：
   - 在编码器中融入化学特征的先验知识（如pH值与酒精浓度的交互效应），通过多头自注意力机制建模特征间的非线性关系。

3. **动态降维选择**：
   - 设计自适应降维模块，根据分类任务需求动态选择2~10维的潜在空间维度，优化计算效率与分类性能。

### 分类模型：高效Res-MLP
- 沿用MNIST的Res-MLP结构，针对Wine数据进一步精简网络层数（3层），降低过拟合风险。
- 引入DropConnect正则化，随机丢弃权重连接，提升小样本场景的泛化能力。

### 数据增强：
- 针对13维特征，实施随机扰动（±5%幅度）、特征掩码（随机置零1~2维）。
- 使用SMOTE算法生成合成样本，平衡类别分布。

---

## 3. 拉曼光谱（Raman Spectra）降维与分类

针对拉曼光谱数据（Raw与Processed，1000维），我们提出基于物理信息嵌入的预处理方法与混合降维架构，结合高效分类模型。

### 数据预处理：Voigt物理信息嵌入
1. **Voigt峰型拟合**：
   - 在插值对齐位移时，采用Voigt函数（高斯与洛伦兹函数的卷积）拟合光谱峰型，嵌入物理特性。
   - Voigt函数形式：
     $$V(x) = \int_{-\infty}^{\infty} G(t) \cdot L(x - t) \, dt$$
     其中，\(G(t)\)为高斯分布，\(L(x)\)为洛伦兹分布。

2. **物理约束插值**：
   - 在插值过程中融入光谱强度与峰位分布的物理约束，通过贝叶斯优化估计插值参数，提升数据真实性。

3. **数据增强策略**：
   - 随机频移（±5 cm⁻¹）、强度扰动（±10%）、随机掩码（10%数据点）。
   - 添加信噪比为3dB的高斯白噪声，模拟真实实验环境。

### 降维算法：PCA+神经网络混合架构
1. **混合降维框架**：
   - 第一阶段：使用PCA降维至50维，充分利用PCA的线性稳定性。
   - 第二阶段：通过深度残差自编码器（Res-AE）进一步降维至2~50维，捕获非线性特征。
   - Res-AE结构：
     $$h = \text{ReLU}(W_1 \cdot x + b_1), \quad z = h + \text{ReLU}(W_2 \cdot h + b_2)$$


### 分类模型：高效MLP
- 使用浅层MLP（2层全连接，128与64神经元），以高效处理PCA+Res-AE降维后的特征。
- 激活函数采用Leaky ReLU，缓解梯度消失问题。

---


## 打包可执行文件命令
```bash
python -m nuitka --standalone --plugin-enable=tk-inter,matplotlib,pyzmq --windows-icon-from-ico=icon.ico --include-module=mnist_inference --include-module=raman_reduction --include-module=wine_inference --include-data-dir=./models=models --include-data-dir=./datas=datas --output-dir=. --output-filename=DimensionReduction --jobs=12 ./launcher.py
```